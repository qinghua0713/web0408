<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {

            padding: 0;
            box-sizing: border-box;
        }

        body,
        html {
            background: whitesmoke;
        }

        .shop {
            width: 425px;
            height: 375px;
            background: #fff;
            margin: 0 auto;
            position: relative;
        }

        .shoppingBox {
            height: calc(100% - 70px);
            width: 100%;

        }

        img {
            width: 70px;
            height: 70px;
            float: left;
        }

        .shopping-item {
            height: 90px;
            width: 100%;
            padding: 10px;
            position: relative;
            box-shadow: 3px 3px 3px #ddd;
        }

        .sigcheck {
            float: left;
            margin-top: 30px;
            margin-right: 10px;

        }

        .describe {
            float: left;
            margin-left: 20px;
        }

        .sigPrice {
            color: gray;
            font-size: 12px;
        }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }

        .add-sub-box {
            width: 100px;
            position: absolute;
            bottom: 10px;
            right: 20px;
            border: 1px solid #9A9A9A;
            text-align: center;
            border-radius: 6px;
            display: flex;
            line-height: 30px;

        }

        .add-sub-box input,
        span {
            width: 33333%;
            height: 30px;
            border: none;
        }

        .add-sub-box input {
            text-align: center;
            border: 1px solid #9A9A9A;
            border-top: 0;
            border-bottom: 0;
        }

        .totalprice {
            width: 100%;
            height: 70px;
            line-height: 70px;
            padding: 0 10px;
            position: absolute;
            bottom: 0;
            background: pink;
        }

        .allcheck {
            float: left;

        }

        .total {
            float: left;
            margin-left: 50px;
        }

        i {
            font-style: normal;
            color: orangered;
        }

        .totalNum {
            height: 70px;
            width: 120px;
            background: orange;
            text-align: center;
            line-height: 70px;
            color: #fff;
            position: absolute;
            right: 0;
            font-size: 14px;
        }
    </style>
</head>

<body>
    <div id="app"></div>

</body>
<script src="./react.js"></script>
<script src="./react-dom.js"></script>
<script src="./browser.min.js"></script>
<script type="text/babel">
   var app = document.getElementById('app');
   var App = React.createClass({
         render:function(){
            return(
              
            <div className='shop'>
                  <div className='shoppingBox'>
    {/*----------第一个商品盒子-----------------------------------------------------------------------------------*/}
                        {this.state.cart.map((item,index)=>{
                             return(
                                <div className='shopping-item' key={item.id}>
                               <div className='sigcheck'>
                                <input  onChange={this.sigChange.bind(this,index)} checked={item.isChecked}    type='checkbox'/>
                              </div>  
                              <img src={item.thumbnail}/>
                               <div className='describe'>
                                  <span>{item.name}</span><br/>
                                  <span className='sigPrice'>￥{item.reduct_price}</span>
                               </div>
                               <div className='add-sub-box'>
                                  <span onClick={this.sub.bind(this,index)}>-</span>
                                  <input onChange={this.writable.bind(this,index)}  value={item.num} type='number'/>
                                  <span onClick={this.add.bind(this,index)}>+</span>
                               </div>
                            </div>
                             )
                        })}
             </div>        
 {/*-----------总价部分----------------------------------------------------------------------------------*/}
                      <div className='totalprice'>
                           <div className='allcheck'>
                              <input type='checkbox' onChange={this.allcheck} checked={this.state.allTrue}/>
                              <span>全选</span>
                           </div>
                           <div className='total'>
                             <span>总价:<i >{this.state.totalprice}</i></span>
                           </div>
                           <div className='totalNum'>
                             <span>去结算:(件)</span>
                           </div>
                      </div>

 {/*---------------------------------------------------------------------------------------------*/}
                  
      </div>
                  
            
            )
         },
         getInitialState:function(){
             return{
                
                 totalprice:0,
                 allTrue:false,
                 cart: [{
				"id": "00001",
				"name": "施华蔻伊采染发膏60ml",
				"thumbnail": "https:\/\/fjlyl.xyz\/assets\/hairDye\/products (1).jpg",
				"reduct_price": "26",
				"num": 1,
				"isChecked": false
			}, {
				"id": "00002",
				"thumbnail": "https:\/\/fjlyl.xyz\/assets\/hairDye\/products (2).jpg",
				"name": "施华蔻伊采染发膏100ml",
				"reduct_price": "69",
				"num": 1,
				"isChecked": false
			}]
             }
         },
         sigChange:function(index,event){
             var cart = this.state.cart     
          cart[index].isChecked =  event.target.checked 
             var allTrue = true
             for(var i = 0; i < cart.length;i++){
                 if(cart[i].isChecked ==false){
                      allTrue = false
                      break
                 } 
             }
             this.setState({
                     allTrue:allTrue,
                     cart:cart
                 })
                 this.total()
         },
         allcheck:function(event){
            var cart = this.state.cart     
              for(var i = 0; i < cart.length;i++){
                  cart[i].isChecked = event.target.checked
              }
              this.setState({
                  cart:cart,
                  allTrue:event.target.checked
              })
              this.total()
         },
         add:function(index,event){
             var cart = this.state.cart
             cart[index].num=parseInt(cart[index].num)+1;
             this.setState({
                 cart:cart
             })
             this.total()
         },
         sub:function(index,event){
             var cart = this.state.cart
            cart[index].num>1?cart[index].num--: cart[index].num
            this.setState({
                cart:cart
            })
            this.total()
         },
         writable:function(index,event){
             var cart = this.state.cart
             cart[index].num = Math.ceil(event.target.value)
             if(cart[index].num<1||isNaN(cart[index].num)){
                cart[index].num = 1
             }
             this.setState({
                 cart:cart
             })
             this.total()
         },
         total:function(event){
             var cart = this.state.cart
             var totalprice = 0
             for(var i = 0; i < cart.length;i++){
                 if(cart[i].isChecked == true){
                    totalprice +=cart[i].num * parseFloat(cart[i].reduct_price)
                 }
             }
             console.log(1111)
             this.setState({
                 cart:cart,
                 totalprice:totalprice
             })
         }
       
   })
    ReactDOM.render(<App/>,app)

</script>

</html>